<h1>San Franciscoi repuloter utas  hulyeseg  forgalma</h1>

import streamlit as st
import pandas as pd
import json
import plotly.express as px

st.set_page_config(page_title="San Francisco UtasstatisztikÃ¡k", layout="wide")

st.title("âœˆï¸ San Francisco - RepÃ¼lÅ‘jÃ¡rat utasstatisztikÃ¡k")

# JSON betÃ¶ltÃ©se
@st.cache_data
def load_data():
    with open("San_Francisco.json", "r", encoding="utf-8") as f:
        data = json.load(f)
    df = pd.DataFrame(data)
    df["Activity Period Start Date"] = pd.to_datetime(df["Activity Period Start Date"])
    return df

df = load_data()

# ğŸ“… DÃ¡tum kivÃ¡lasztÃ¡sa
all_dates = sorted(df["Activity Period Start Date"].dt.strftime("%Y-%m-%d").unique())
selected_date = st.selectbox("ğŸ“… VÃ¡lassz hÃ³napot", all_dates)
selected_date_parsed = pd.to_datetime(selected_date)
filtered_df = df[df["Activity Period Start Date"] == selected_date_parsed]

# ğŸŒ RÃ©giÃ³nkÃ©nti eloszlÃ¡s - kÃ¶rdiagram
st.subheader("ğŸŒ RÃ©giÃ³nkÃ©nti utasszÃ¡m eloszlÃ¡s")
if not filtered_df.empty:
    region_sum = filtered_df.groupby("GEO Region")["Passenger Count"].sum().reset_index()
    fig1 = px.pie(region_sum, names="GEO Region", values="Passenger Count", hole=0.4)
    st.plotly_chart(fig1, use_container_width=True)
else:
    st.warning("Nincs adat a kivÃ¡lasztott dÃ¡tumra.")

# âœˆï¸ Top 10 lÃ©gitÃ¡rsasÃ¡g - oszlopdiagram
st.subheader("âœˆï¸ Top 10 lÃ©gitÃ¡rsasÃ¡g (utasok szÃ¡ma)")
if not filtered_df.empty:
    top_airlines = (
        filtered_df.groupby("Operating Airline")["Passenger Count"]
        .sum()
        .sort_values(ascending=False)
        .head(10)
        .reset_index()
    )
    fig2 = px.bar(
        top_airlines,
        x="Operating Airline",
        y="Passenger Count",
        color="Operating Airline",
        text="Passenger Count"
    )
    st.plotly_chart(fig2, use_container_width=True)
else:
    st.info("Nem talÃ¡lhatÃ³ elÃ©g adat a lÃ©gitÃ¡rsasÃ¡gokhoz ezen a dÃ¡tumon.")

# ğŸ“ˆ RÃ©giÃ³nkÃ©nti trend - vonaldiagram
st.subheader("ğŸ“ˆ RÃ©giÃ³nkÃ©nti trend (Ã¶sszes hÃ³napra)")
time_series = (
    df.groupby(["Activity Period Start Date", "GEO Region"])["Passenger Count"]
    .sum()
    .reset_index()
)
fig3 = px.line(
    time_series,
    x="Activity Period Start Date",
    y="Passenger Count",
    color="GEO Region",
    markers=True
)
st.plotly_chart(fig3, use_container_width=True)

# ğŸ“‹ RÃ©szletes tÃ¡blÃ¡zat
st.subheader("ğŸ“‹ RÃ©szletes adatok a kivÃ¡lasztott hÃ³napban")
st.dataframe(filtered_df.reset_index(drop=True))


  
